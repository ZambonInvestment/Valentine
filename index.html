<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>San Valentino ðŸ’–</title>

<style>
body {
  margin: 0;
  font-family: Arial;
  background: linear-gradient(#ffd6e7, #fff0f5);
  text-align: center;
  overflow: hidden;
}

.section {
  display: none;
  height: 100vh;
  width: 100vw;
}

.active {
  display: flex;
  flex-direction: column;
  justify-content: space-evenly;
  align-items: center;
}

h1 { font-size: 38px; }
h2 { font-size: 28px; }

button {
  width: 90%;
  padding: 22px;
  font-size: 26px;
  border-radius: 16px;
  border: none;
}

.grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
  width: 95vw;
}

img {
  width: 100%;
  height: 22vh;
  object-fit: cover;
  border-radius: 14px;
  border: 5px solid transparent;
}

.selected { border: 5px solid red; }
</style>
</head>

<body>

<!-- GIOCO -->
<div id="game" class="section active">
  <h1>ðŸ’– Be my valentine? ðŸ’–</h1>

  <button id="yesBtn"
    onclick="startCaptcha()"
    style="background:#ff4d88;color:white;">
    YES ðŸ’˜
  </button>

  <button id="noBtn"
    onmouseover="escapeNo()"
    ontouchstart="escapeNo()">
    No ðŸ˜¢
  </button>
</div>

<!-- CAPTCHA -->
<div id="captcha" class="section">
  <h2>Trova tutte le mie foto ðŸ˜‰</h2>

  <div class="grid">
    <img src="me1.jpg" onclick="toggle(this,true)">
    <img src="random1.jpg" onclick="toggle(this,false)">
    <img src="me2.jpg" onclick="toggle(this,true)">
    <img src="random2.jpg" onclick="toggle(this,false)">
    <img src="me3.jpg" onclick="toggle(this,true)">
    <img src="random3.jpg" onclick="toggle(this,false)">
  </div>

  <button onclick="checkCaptcha()">Verifica ðŸ’Œ</button>
</div>

<script>
function escapeNo() {
  const btn = document.getElementById("noBtn");
  btn.innerText = "YES ðŸ’˜";
  btn.style.position = "absolute";
  btn.style.left = Math.random() * 60 + "%";
  btn.style.top = Math.random() * 70 + "%";
}

function startCaptcha() {
  document.getElementById("game").classList.remove("active");
  document.getElementById("captcha").classList.add("active");
}

let correct = new Set();
let selected = new Set();

function toggle(img, isCorrect) {
  img.classList.toggle("selected");
  const id = img.src;

  if (selected.has(id)) selected.delete(id);
  else selected.add(id);

  if (isCorrect) correct.add(id);
}

function checkCaptcha() {
  let success = true;

  correct.forEach(id => {
    if (!selected.has(id)) success = false;
  });

  if (success && selected.size === correct.size) {
    window.location.href = "regalo.html"; // ðŸ‘‰ REDIRECT
  } else {
    alert("Riprova amore ðŸ˜˜");
  }
}
</script>

</body>
</html>